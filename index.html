<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†Œì•„ì„±ì¥ AI ì±—ë´‡ v3.1</title>
    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f4f7f6; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .chat-container { width: 400px; height: 600px; background: white; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); display: flex; flex-direction: column; overflow: hidden; }
        .header { background: #2ecc71; color: white; padding: 20px; text-align: center; font-weight: bold; }
        #chat-window { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .message { padding: 10px 15px; border-radius: 15px; max-width: 80%; line-height: 1.4; font-size: 14px; }
        .user { align-self: flex-end; background: #2ecc71; color: white; }
        .bot { align-self: flex-start; background: #f0f0f0; color: #333; }
        .input-area { border-top: 1px solid #eee; padding: 15px; display: flex; gap: 10px; }
        input { flex: 1; border: 1px solid #ddd; padding: 10px; border-radius: 5px; outline: none; }
        button { background: #2ecc71; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; }
    </style>
</head>
<body>

<div class="chat-container">
    <div class="header">ğŸ¥ ì†Œì•„ì„±ì¥ AI ì±—ë´‡ (Gemini)</div>
    <div id="chat-window">
        <div class="message bot">ì•ˆë…•í•˜ì„¸ìš”! ì†Œì•„ ì„±ì¥ê³¼ ì„±ì¡°ìˆ™ì¦ì— ëŒ€í•´ ë¬´ì—‡ì´ë“  ë¬¼ì–´ë³´ì„¸ìš”. ğŸ˜Š</div>
    </div>
    <div class="input-area">
        <input type="text" id="user-input" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="if(event.keyCode==13) sendMessage()">
        <button onclick="sendMessage()">ì „ì†¡</button>
    </div>
</div>

<script type="module">
    import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

    // 1. ì œê³µí•´ì£¼ì‹  API í‚¤ë¥¼ ì—¬ê¸°ì— ì…ë ¥í•©ë‹ˆë‹¤.
    const API_KEY = "AIzaSyA1npxgOEe70Q-hbflJTZTGzpwjYoxSUI4";
    const genAI = new GoogleGenerativeAI(API_KEY);

    // 2. ì±—ë´‡ì˜ í˜ë¥´ì†Œë‚˜ì™€ ì§€ì‹ ë² ì´ìŠ¤ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
    const systemInstruction = `
        ë‹¹ì‹ ì€ ì†Œì•„ì„±ì¥ ë° ì„±ì¡°ìˆ™ì¦ ì „ë¬¸ AI ìƒë‹´ì‚¬ì…ë‹ˆë‹¤. 
        ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ëŒ€í•´ ë‹¤ìŒ ì§€ì¹¨ì„ ë°˜ë“œì‹œ ë”°ë¥´ì„¸ìš”:
        
        1. ë¹„ìš© ê´€ë ¨ ì§ˆë¬¸ì´ ë“¤ì–´ì˜¤ë©´ ë°˜ë“œì‹œ ì•„ë˜ ì •ë³´ë¥¼ ìš°ì„ ì ìœ¼ë¡œ ë‹µí•˜ì„¸ìš”:
           - ì„±ì¥í˜¸ë¥´ëª¬ ê²€ì‚¬ë¹„: ì•½ 10~20ë§Œì› ë‚´ì™¸ (ë³‘ì›ë³„ ìƒì´)
           - ì„±ì¥í˜¸ë¥´ëª¬ ì¹˜ë£Œë¹„: ì•„ì´ì˜ ëª¸ë¬´ê²Œì— ë”°ë¼ ë‹¤ë¥´ë‚˜ ì›” í‰ê·  80~120ë§Œì› ë‚´ì™¸
        2. ì§ˆë¬¸ì˜ í•µì‹¬ ì˜ë„ë¥¼ íŒŒì•…í•˜ì„¸ìš”. 'ë¹„ìš©'ì„ ë¬¼ì—ˆëŠ”ë° 'ì¸ìŠë¦°'ì´ë‚˜ 'ë¹„ë§Œ' ì´ì•¼ê¸°ë¥¼ ë¨¼ì € í•˜ì§€ ë§ˆì„¸ìš”.
        3. ë‹µë³€ì€ í•­ìƒ ì¹œì ˆí•˜ê³  ì‹ ë¢°ê° ìˆëŠ” ë§íˆ¬ë¡œ ì‘ì„±í•˜ì„¸ìš”.
    `;

    async function sendMessage() {
        const inputField = document.getElementById('user-input');
        const chatWindow = document.getElementById('chat-window');
        const userText = inputField.value.trim();

        if (!userText) return;

        // ì‚¬ìš©ì ë©”ì‹œì§€ í‘œì‹œ
        appendMessage('user', userText);
        inputField.value = '';

        try {
            // Gemini ëª¨ë¸ í˜¸ì¶œ (ë¬´ë£Œ í‹°ì–´ 1.5 Flash ê¶Œì¥)
            const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
            
            // ì‹œìŠ¤í…œ ì§€ì¹¨ê³¼ ì‚¬ìš©ì ì§ˆë¬¸ì„ í•©ì³ì„œ ì „ì†¡
            const prompt = `${systemInstruction}\n\nì‚¬ìš©ì ì§ˆë¬¸: ${userText}`;
            const result = await model.generateContent(prompt);
            const response = await result.response;
            const botText = response.text();

            // ë´‡ ë©”ì‹œì§€ í‘œì‹œ
            appendMessage('bot', botText);
        } catch (error) {
            console.error(error);
            appendMessage('bot', "ì£„ì†¡í•©ë‹ˆë‹¤. ì ì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
        }
    }

    function appendMessage(sender, text) {
        const chatWindow = document.getElementById('chat-window');
        const msgDiv = document.createElement('div');
        msgDiv.classList.add('message', sender);
        msgDiv.innerText = text;
        chatWindow.appendChild(msgDiv);
        chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    // ì „ì—­ í•¨ìˆ˜ ë“±ë¡
    window.sendMessage = sendMessage;
</script>

</body>
</html>


