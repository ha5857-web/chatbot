<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏÜåÏïÑÏÑ±Ïû• ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Ï±óÎ¥á</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; padding: 20px;
        }
        .container {
            max-width: 800px; margin: 0 auto;
            background: white; border-radius: 20px; 
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #00B050 0%, #00d561 100%);
            color: white; padding: 30px; text-align: center;
        }
        .header h1 { font-size: 24px; margin-bottom: 10px; }
        .header p { font-size: 14px; opacity: 0.9; }
        .badge {
            background: rgba(255,255,255,0.2);
            padding: 5px 15px; border-radius: 15px;
            font-size: 12px; display: inline-block; margin-top: 10px;
        }
        .content { padding: 30px; }
        .tree { list-style: none; }
        .tree-item { margin: 10px 0; }
        .tree-main { 
            background: #f8f9fa; padding: 15px 20px; border-radius: 10px;
            cursor: pointer; display: flex; align-items: center; gap: 10px;
            transition: all 0.3s; border-left: 4px solid #00B050;
        }
        .tree-main:hover { background: #e9ecef; transform: translateX(5px); }
        .tree-main .icon { font-size: 20px; }
        .tree-main .title { font-weight: 600; font-size: 16px; flex: 1; }
        .tree-main .count { 
            background: #00B050; color: white; 
            padding: 3px 10px; border-radius: 12px; font-size: 12px;
        }
        .tree-main .arrow { 
            transition: transform 0.3s;
            font-size: 12px; color: #666;
        }
        .tree-main.active .arrow { transform: rotate(90deg); }
        
        .tree-sub { 
            list-style: none; padding-left: 20px; 
            max-height: 0; overflow: hidden; 
            transition: max-height 0.3s ease-out;
        }
        .tree-sub.active { max-height: 2000px; transition: max-height 0.5s ease-in; }
        
        .tree-sub-item { 
            background: white; margin: 10px 0; padding: 12px 15px;
            border-radius: 8px; cursor: pointer;
            border-left: 3px solid #6c757d; transition: all 0.2s;
            display: flex; align-items: center; gap: 10px;
        }
        .tree-sub-item:hover { 
            background: #f8f9fa; transform: translateX(5px);
            border-left-color: #00B050;
        }
        .tree-sub-item .icon { font-size: 16px; }
        .tree-sub-item .title { flex: 1; font-size: 14px; font-weight: 500; }
        .tree-sub-item .count { 
            background: #6c757d; color: white;
            padding: 2px 8px; border-radius: 10px; font-size: 11px;
        }
        
        .questions { 
            list-style: none; padding-left: 20px;
            max-height: 0; overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .questions.active { max-height: 5000px; transition: max-height 0.5s ease-in; }
        
        .question-item {
            background: #f8f9fa; margin: 8px 0; padding: 12px 15px;
            border-radius: 8px; cursor: pointer;
            border-left: 3px solid #dee2e6; transition: all 0.2s;
            font-size: 13px;
        }
        .question-item:hover {
            background: #e9ecef; border-left-color: #00B050;
        }
        
        .answer-panel {
            position: fixed; top: 0; right: -100%; width: 100%; max-width: 500px;
            height: 100vh; background: white; box-shadow: -5px 0 20px rgba(0,0,0,0.3);
            transition: right 0.3s; z-index: 1000; overflow-y: auto;
        }
        .answer-panel.active { right: 0; }
        
        .answer-header {
            background: linear-gradient(135deg, #00B050 0%, #00d561 100%);
            color: white; padding: 20px; position: sticky; top: 0; z-index: 1;
        }
        .close-btn {
            background: rgba(255,255,255,0.2); border: none;
            color: white; padding: 8px 15px; border-radius: 8px;
            cursor: pointer; font-size: 14px; margin-bottom: 10px;
        }
        .close-btn:hover { background: rgba(255,255,255,0.3); }
        
        .answer-content { padding: 20px; }
        .answer-question {
            font-size: 18px; font-weight: 600; color: #00B050;
            margin-bottom: 15px; padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }
        .answer-text {
            line-height: 1.8; color: #333; font-size: 15px;
            white-space: pre-line;
        }
        .video-button {
            display: inline-block; margin-top: 20px; padding: 12px 24px;
            background: #FF0000; color: white; text-decoration: none;
            border-radius: 25px; font-size: 14px; transition: background 0.3s;
        }
        .video-button:hover { background: #cc0000; }
        
        .search-box {
            margin-bottom: 20px; position: relative;
        }
        .search-input {
            width: 100%; padding: 15px 45px 15px 20px;
            border: 2px solid #e9ecef; border-radius: 12px;
            font-size: 15px; outline: none; transition: border 0.3s;
        }
        .search-input:focus { border-color: #00B050; }
        .search-icon {
            position: absolute; right: 15px; top: 50%;
            transform: translateY(-50%); color: #999;
        }
        
        @media (max-width: 768px) {
            .container { border-radius: 0; }
            .answer-panel { max-width: 100%; }
        }
    </style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üè• ÏÜåÏïÑÏÑ±Ïû• ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò</h1>
        <p>Ïπ¥ÌÖåÍ≥†Î¶¨Î•º ÏÑ†ÌÉùÌïòÏó¨ ÏõêÌïòÎäî Ï†ïÎ≥¥Î•º Ï∞æÏïÑÎ≥¥ÏÑ∏Ïöî</p>
        <div class="badge">üìÅ Ìä∏Î¶¨ Íµ¨Ï°∞ Î∞©Ïãù ¬∑ 435Í∞ú Q&A (99.5%)</div>
    </div>
    
    <div class="content">
        <div class="search-box">
            <input type="text" class="search-input" id="searchInput" 
                   placeholder="ÏßàÎ¨∏ Í≤ÄÏÉâ... (Ïòà: ÏÑ±Ï°∞ÏàôÏ¶ù, ÏÑ±Ïû•Ìò∏Î•¥Î™¨)">
            <span class="search-icon">üîç</span>
        </div>
        
        <ul class="tree" id="tree"></ul>
    </div>
</div>

<div class="answer-panel" id="answerPanel">
    <div class="answer-header">
        <button class="close-btn" onclick="closeAnswer()">‚Üê ÎèåÏïÑÍ∞ÄÍ∏∞</button>
        <div class="answer-question" id="answerQuestion"></div>
    </div>
    <div class="answer-content">
        <div class="answer-text" id="answerText"></div>
        <div id="videoLink"></div>
    </div>
</div>

<script>
let treeData = null;

// Îç∞Ïù¥ÌÑ∞ Î°úÎìú
window.addEventListener('load', async function() {
    try {
        const response = await fetch('tree_structure_complete.json');
        treeData = await response.json();
        renderTree();
    } catch (error) {
        console.error('Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', error);
        alert('Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.');
    }
});

function renderTree() {
    const treeEl = document.getElementById('tree');
    treeEl.innerHTML = '';
    
    const categories = {
        'ÏÑ±Ï°∞ÏàôÏ¶ù': 'üéÄ',
        'ÏÑ±Ïû•Ìò∏Î•¥Î™¨': 'üíâ',
        'ÏÜåÏïÑÎπÑÎßå': '‚öñÔ∏è',
        'ÌÇ§ÏÑ±Ïû•': 'üìè',
        'Ïú†Ï†Ñ': 'üß¨',
        'ÏòÅÏñë': 'ü•ó',
        'Ï≤¥Ï§ëÍ¥ÄÎ¶¨': 'üí™',
        'Í≤ÄÏÇ¨': 'üî¨',
        'ÏÉùÌôúÏäµÍ¥Ä': '‚è∞',
        'ÏÑ±Ïû•Ïû•Ïï†': 'üè•',
        'Í∏∞ÌÉÄ': 'üìã'
    };
    
    for (const [mainCat, subCats] of Object.entries(treeData)) {
        const totalCount = Object.values(subCats).reduce((sum, items) => sum + items.length, 0);
        if (totalCount === 0) continue;
        
        const mainItem = document.createElement('li');
        mainItem.className = 'tree-item';
        
        const mainDiv = document.createElement('div');
        mainDiv.className = 'tree-main';
        mainDiv.innerHTML = `
            <span class="icon">${categories[mainCat] || 'üìÅ'}</span>
            <span class="title">${mainCat}</span>
            <span class="count">${totalCount}Í∞ú</span>
            <span class="arrow">‚ñ∂</span>
        `;
        
        const subUl = document.createElement('ul');
        subUl.className = 'tree-sub';
        
        for (const [subCat, items] of Object.entries(subCats)) {
            if (items.length === 0) continue;
            
            const subLi = document.createElement('li');
            const subDiv = document.createElement('div');
            subDiv.className = 'tree-sub-item';
            subDiv.innerHTML = `
                <span class="icon">üìÇ</span>
                <span class="title">${subCat}</span>
                <span class="count">${items.length}</span>
            `;
            
            const questionsUl = document.createElement('ul');
            questionsUl.className = 'questions';
            
            items.forEach(item => {
                const qLi = document.createElement('li');
                qLi.className = 'question-item';
                qLi.textContent = item.question;
                qLi.onclick = () => showAnswer(item);
                questionsUl.appendChild(qLi);
            });
            
            subDiv.onclick = (e) => {
                e.stopPropagation();
                subDiv.classList.toggle('active');
                questionsUl.classList.toggle('active');
            };
            
            subLi.appendChild(subDiv);
            subLi.appendChild(questionsUl);
            subUl.appendChild(subLi);
        }
        
        mainDiv.onclick = () => {
            mainDiv.classList.toggle('active');
            subUl.classList.toggle('active');
        };
        
        mainItem.appendChild(mainDiv);
        mainItem.appendChild(subUl);
        treeEl.appendChild(mainItem);
    }
}

function showAnswer(item) {
    document.getElementById('answerQuestion').textContent = item.question;
    document.getElementById('answerText').textContent = item.answer;
    
    const videoLinkDiv = document.getElementById('videoLink');
    if (item.video && item.video !== 'nan') {
        videoLinkDiv.innerHTML = `
            <a href="${item.video}" target="_blank" class="video-button">
                üì∫ ÏòÅÏÉÅÏúºÎ°ú ÏûêÏÑ∏Ìûà Î≥¥Í∏∞
            </a>
        `;
    } else {
        videoLinkDiv.innerHTML = '';
    }
    
    document.getElementById('answerPanel').classList.add('active');
}

function closeAnswer() {
    document.getElementById('answerPanel').classList.remove('active');
}

// Í≤ÄÏÉâ Í∏∞Îä•
document.getElementById('searchInput').addEventListener('input', function(e) {
    const searchTerm = e.target.value.toLowerCase();
    
    if (!searchTerm) {
        renderTree();
        return;
    }
    
    const filtered = {};
    for (const [mainCat, subCats] of Object.entries(treeData)) {
        filtered[mainCat] = {};
        for (const [subCat, items] of Object.entries(subCats)) {
            const matchedItems = items.filter(item => 
                item.question.toLowerCase().includes(searchTerm) ||
                (item.keywords && item.keywords.toLowerCase().includes(searchTerm))
            );
            if (matchedItems.length > 0) {
                filtered[mainCat][subCat] = matchedItems;
            }
        }
    }
    
    const temp = treeData;
    treeData = filtered;
    renderTree();
    
    // Î™®Îì† Ìä∏Î¶¨ ÏûêÎèô ÌéºÏπòÍ∏∞
    document.querySelectorAll('.tree-main, .tree-sub-item').forEach(el => {
        el.classList.add('active');
    });
    document.querySelectorAll('.tree-sub, .questions').forEach(el => {
        el.classList.add('active');
    });
    
    treeData = temp;
});
</script>
</body>
</html>
